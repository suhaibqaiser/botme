<div class="card">
  <div class="card-header">
    <h3 class="card-title">
      <i class="fas fa-brain mr-2"></i>
      <p-inplace [closable]="closable" [style]="{'display': 'inline-block'}">
        <ng-template pTemplate="display">
          <i class="pi pi-pencil"></i> {{corpus.name}}
        </ng-template>
        <ng-template pTemplate="content">
          <input type="text" value="Corpus Name" [(ngModel)]="corpus.name" pInputText>
        </ng-template>
      </p-inplace>
    </h3>
    <div class="card-tools">
      <button *ngIf="editMode" type="button" class="p-button p-button-outlined" (click)="saveChanges()">Save
        Changes</button>
      <button *ngIf="!editMode" type="button" class="p-button p-button-outlined" (click)="addCorups()">Add
        Corpus</button>
    </div>
  </div>
  <!-- /.card-header -->
  <div class="card-body row">
    <div class="col-md-6">
      <dl>
        <dt>Corpus ID</dt>
        <dd>
          <p-inplace [closable]="closable" [style]="{'min-height':'33px'}">
            <ng-template pTemplate="display">
              <i class="pi pi-pencil"></i> {{corpus.corpusId}}
            </ng-template>
            <ng-template pTemplate="content">
              <input type="text" value="Corpus Id" [(ngModel)]="corpus.corpusId" pInputText>
            </ng-template>
          </p-inplace>
        </dd>
        <dt>Locale</dt>
        <dd>
          <p-inplace [closable]="closable" [style]="{'min-height':'33px'}">
            <ng-template pTemplate="display">
              <i class="pi pi-pencil"></i> {{corpus.locale}}
            </ng-template>
            <ng-template pTemplate="content">
              <input type="text" value="Corpus Name" [(ngModel)]="corpus.locale" pInputText>
            </ng-template>
          </p-inplace>
        </dd>
      </dl>
    </div>
    <div class="col-md-6">
      <dl>
        <dt>Comments</dt>
        <dd>
          <p-inplace [closable]="closable" [style]="{'min-height':'33px'}">
            <ng-template pTemplate="display">
              <i class="pi pi-pencil"></i> {{corpus.comment}}
            </ng-template>
            <ng-template pTemplate="content">
              <input type="text" value="Corpus Name" [(ngModel)]="corpus.comment" pInputText>
            </ng-template>
          </p-inplace>
        </dd>
        <dt>Active</dt>
        <dd>
          <p-selectButton [options]="stateOptions" [(ngModel)]="corpus.active" optionLabel="label" optionValue="value">
          </p-selectButton>
        </dd>
      </dl>
    </div>
  </div>
  <!-- /.card-body -->
</div>
<!-- /.card -->

<div class="row">
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">NLU Details</h3>

      </div>
      <div class="card-body p-0">
        <p-tabView (onChange)="setTypeOnTabChange($event)">
          <p-tabPanel header="Intents">
            <div class="card-tools">
              <button type="button" class="p-button p-button-sm" data-toggle="modal" data-target="#typeModal">
                <i class="pi pi-plus"></i> Add New
              </button>
            </div>
            <p-table [value]="intents" editMode="row" dataKey="id" selectionMode="single"
              (onRowSelect)="setExamples($event)">
              <ng-template pTemplate="header">
                <tr>
                  <th>Intent</th>
                  <th style="width:8rem">Action</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-intent let-editing="editing" let-ri="rowIndex">
                <tr [pEditableRow]="intent" [pSelectableRow]="intent">
                  <td>
                    <p-cellEditor>
                      <ng-template pTemplate="input">
                        <input pInputText type="text" [(ngModel)]="intent.name" style="width: 100%">
                      </ng-template>
                      <ng-template pTemplate="output">
                        {{intent.name}}
                      </ng-template>
                    </p-cellEditor>
                  </td>
                  <td style="text-align:center">
                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                      class="p-button-rounded p-button-text"></button>

                    <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-trash"
                      (click)="deleteType(intent)" class="p-button-rounded p-button-text p-button-danger"></button>

                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                      class="p-button-rounded p-button-text p-button-success p-mr-2"></button>
                    <!--                <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"-->
                    <!--                        class="p-button-rounded p-button-text p-button-danger"></button>-->
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-tabPanel>
          <p-tabPanel header="Lookups">
            <button type="button" class="p-button p-button-sm" data-toggle="modal" data-target="#typeModal">
              <i class="pi pi-plus"></i> Add New
            </button>
            <p-table [value]="lookups" editMode="row" dataKey="_id" selectionMode="single"
              (onRowSelect)="setExamples($event)">
              <ng-template pTemplate="header">
                <tr>
                  <th>Lookups</th>
                  <th style="width:8rem">Action</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-lookup let-editing="editing" let-ri="rowIndex">
                <tr [pEditableRow]="lookup" [pSelectableRow]="lookup">
                  <td>
                    <p-cellEditor>
                      <ng-template pTemplate="input">
                        <input pInputText type="text" [(ngModel)]="lookup.name" style="width: 100%">
                      </ng-template>
                      <ng-template pTemplate="output">
                        {{lookup.name}}
                      </ng-template>
                    </p-cellEditor>
                  </td>
                  <td style="text-align:center">
                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                      class="p-button-rounded p-button-text"></button>

                    <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-trash"
                      (click)="deleteType(lookup)" class="p-button-rounded p-button-text p-button-danger"></button>

                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                      class="p-button-rounded p-button-text p-button-success p-mr-2"></button>
                    <!--                <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"-->
                    <!--                        class="p-button-rounded p-button-text p-button-danger"></button>-->
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-tabPanel>
          <p-tabPanel header="Regexes">
            <button type="button" class="p-button p-button-sm" data-toggle="modal" data-target="#typeModal">
              <i class="pi pi-plus"></i> Add New
            </button>
            <p-table [value]="regexes" editMode="row" dataKey="_id" selectionMode="single"
              (onRowSelect)="setExamples($event)">
              <ng-template pTemplate="header">
                <tr>
                  <th>Regexes</th>
                  <th style="width:8rem">Action</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-regex let-editing="editing" let-ri="rowIndex">
                <tr [pEditableRow]="regex" [pSelectableRow]="regex">
                  <td>
                    <p-cellEditor>
                      <ng-template pTemplate="input">
                        <input pInputText type="text" [(ngModel)]="regex.name" style="width: 100%">
                      </ng-template>
                      <ng-template pTemplate="output">
                        {{regex.name}}
                      </ng-template>
                    </p-cellEditor>
                  </td>
                  <td style="text-align:center">
                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                      class="p-button-rounded p-button-text"></button>

                    <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-trash"
                      (click)="deleteType(regex)" class="p-button-rounded p-button-text p-button-danger"></button>

                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                      class="p-button-rounded p-button-text p-button-success p-mr-2"></button>
                    <!--                <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"-->
                    <!--                        class="p-button-rounded p-button-text p-button-danger"></button>-->
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-tabPanel>
          <p-tabPanel header="Synonyms">
            <button type="button" class="p-button p-button-sm" data-toggle="modal" data-target="#typeModal">
              <i class="pi pi-plus"></i> Add New
            </button>
            <p-table [value]="synonyms" editMode="row" dataKey="_id" selectionMode="single"
              (onRowSelect)="setExamples($event)">
              <ng-template pTemplate="header">
                <tr>
                  <th>Synonyms</th>
                  <th style="width:8rem">Action</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-synonym let-editing="editing" let-ri="rowIndex">
                <tr [pEditableRow]="synonym" [pSelectableRow]="synonym">
                  <td>
                    <p-cellEditor>
                      <ng-template pTemplate="input">
                        <input pInputText type="text" [(ngModel)]="synonym.name" style="width: 100%">
                      </ng-template>
                      <ng-template pTemplate="output">
                        {{synonym.name}}
                      </ng-template>
                    </p-cellEditor>
                  </td>
                  <td style="text-align:center">
                    <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                      class="p-button-rounded p-button-text"></button>

                    <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-trash"
                      (click)="deleteType(synonym)" class="p-button-rounded p-button-text p-button-danger"></button>

                    <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                      class="p-button-rounded p-button-text p-button-success p-mr-2"></button>
                    <!--                <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times"-->
                    <!--                        class="p-button-rounded p-button-text p-button-danger"></button>-->
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </p-tabPanel>
        </p-tabView>
      </div>
      <!-- /.card-body -->
    </div>
  </div>

  <!-- Section: Example -->
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-microphone-alt mr-2"></i>
          Examples
        </h3>
        <div class="card-tools">

          <button type="button" class="p-button p-button-sm" data-toggle="modal" data-target="#exampleModal"><i
              class="pi pi-plus"></i> Add
            New
          </button>
        </div>
      </div>
      <!-- /.card-header -->
      <div class="card-body p-0">
        <p-table [value]="examples" editMode="row" [rowHover]="true" dataKey="id">
          <!--                 (onRowSelect)="onItemSelected($event)"-->
          <ng-template pTemplate="header">
            <tr>
              <th>Phrase</th>
              <th style="width:8rem">Action</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-example let-editing="editing" let-ri="rowIndex">
            <tr [pEditableRow]="example">
              <td>
                <p-cellEditor>
                  <ng-template pTemplate="input">
                    <input pInputText type="text" [(ngModel)]="example.example" style="width: 100%">
                  </ng-template>
                  <ng-template pTemplate="output">
                    {{example.example}}
                  </ng-template>
                </p-cellEditor>
              </td>
              <td style="text-align:center">
                <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil"
                  class="p-button-rounded p-button-text"></button>

                <button *ngIf="!editing" pButton pRipple type="button" icon="pi pi-trash"
                  (click)="deleteExample(example)" class="p-button-rounded p-button-text p-button-danger"></button>

                <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check"
                  (click)="updateExamples()" class="p-button-rounded p-button-text p-button-success p-mr-2"></button>
              </td>
            </tr>
          </ng-template>
        </p-table>
        <!-- card-body -->
      </div>
      <!-- /.card -->
    </div>
  </div>
</div>

<!-- Add new type Modal -->
<div class="modal" id="typeModal" tabindex="-1" role="dialog" aria-labelledby="typeModalTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="typeModalTitle">New {{type}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="capitalize">{{type}} Identifier</p>
        <input [(ngModel)]="InputNewType" type="text" #newType />
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal"
          (click)="addNewType(type ,newType.value)">Add</button>
      </div>
    </div>
  </div>
</div>


<!-- Add new example Modal -->
<div class="modal" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalTitle">New Example</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p class="capitalize">Example Identifier</p>
        <input [(ngModel)]="InputNewExample" type="text" #newExample />
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="addNewExample()">Add</button>
      </div>
    </div>
  </div>
</div>